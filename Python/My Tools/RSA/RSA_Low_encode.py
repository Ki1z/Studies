# 低加密指数攻击
import gmpy2
import os
from functools import reduce 
from Crypto.Util.number import long_to_bytes 
def CRT(items):
    N = reduce(lambda x, y: x * y, (i[1] for i in items))
    result = 0
    for a, n in items:
        m = N // n
        d, r, s = gmpy2.gcdext(n, m)
        if d != 1:
            raise Exception("Input not pairwise co-prime")
        result += a * s * m
    return result % N, N
# e, n, c
e=65537
n=[12872311844796335551074772926373442157584207393868495851604773915402573049905020786883935496452654953182028422239889519866798473860330700762324494226757523208430629280963673244580900642802613477278622107025994098955715529159364503684996390392870614975557242855553151220373699874977684957792556070396045575585134086316066211567151217961741210892593858681987222776416960335601990219681817959094253930024878375582517316502091321736391906696168378868287901493175466496043572325201642173497838277126933218828358564443772474000457448713435536967737757982044937175519657867854547932884151120179002864724013116653807902692637]
c=[9132582410761466193897393860943366992045516908322696055882421527052610500121891193136852494077311298577641886692181159438065660446662754105849323312928620489217571402954575229902509545202861138414515107447794944344598744230530961197099220658114404726362543877191904637729863906963841100167814779606979014982383413687565793725075500441872139157678937789220295680934581953982434770689821811167304885893774840050051446190132541313031028882692122429222790715135491595434135834488277926897887734937555589905152137558556293999414724378085536870794501987540152168612980967420475826314881377426621602225280131752264612573606]
#########
data = list(zip(c, n))
x, n = CRT(data)
m = gmpy2.iroot(gmpy2.mpz(), e)[0].digits()
print(m)
print('m is: ' + str(long_to_bytes(m)))
