# 低加密指数攻击
import gmpy2
import os
from functools import reduce 
from Crypto.Util.number import long_to_bytes 
def CRT(items):
    N = reduce(lambda x, y: x * y, (i[1] for i in items))
    result = 0
    for a, n in items:
        m = N // n
        d, r, s = gmpy2.gcdext(n, m)
        if d != 1:
            raise Exception("Input not pairwise co-prime")
        result += a * s * m
    return result % N, N
# e, n, c
e=65537
n=[26855251020322647800995675284309891220079320186847645066358227671642791081119890111589910206778294139922597369601147527811686217156292258750078317067557167851765445131375992524142388756844814407423307064257467752990731866622412491728407959435110508364584652616586104258704247916288967662995450661283828053434391961142193881069964021054436340652620588206877449539755731993201404333962649230316208987584344201193160763357901666315047105330540811073553441076691634473725905099553988885966651683471725565773691407975890236350277392019642437181815745484845727021611316299335377465052954842672840124995405141309500897901741]
c=[13544774822529968520373754756829967308657716195838754418703082941255997237013293584095895675322972166079694313655086591199616242775309213971731203077436068888558156211263525099465782948998648995082977953502523073089123196008708594855428042097613498740453312412072206028075529533531906419456642615674148316038814593928872683636459803157531349043571370846990671360775871025271358727153829917756844119715962170928822738609307242404195451445217502148769605965468074872310884719122921554181494226792954084800006182894350372883371471742524947980423478409880533644406795594605030833160299219652657700151935867700993402791187]
#########
data = list(zip(c, n))
x, n = CRT(data)
m = gmpy2.iroot(gmpy2.mpz(x), e)[0].digits()
print(m)
print('m is: ' + str(long_to_bytes(m)))
